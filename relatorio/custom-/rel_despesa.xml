<?xml version='1.0' encoding='iso8859-1'?>
<relatorio ts="2008-09-08 15:30:33" versao_xml="0.1"><tela titulo="Despesas">
  <quadro titulo="Parâmetros">
    <procura id="empresa" modelo="empresa" titulo="Empresa" valor_padrao="select grid from empresa_local" />
    <campo id="data_emis" modelo="periodo" titulo="Emissão entre" valor_padrao="select to_char(current_date, &apos;YYYY-mm-01&apos;)::date, to_char(current_date + interval &apos;1 month&apos;, &apos;YYYY-mm-01&apos;)::date - 1" />
    <campo id="data_pgto" modelo="periodo" titulo="Pagto entre" />
    <procura condicao="codigo like (select codigo from conta where nome=&apos;DESPESAS&apos;)||&apos;%&apos;" id="conta" modelo="conta" titulo="Conta" valor_padrao="select codigo from conta where nome=&apos;DESPESAS&apos;" />
    <check id="listar_subconta" titulo="Listar sub-contas" valor_padrao="select true" />
  </quadro>
</tela><ajuda>&lt;big&gt;&lt;b&gt;Relatorio de Despesa/b&gt;&lt;/big&gt;

Este relatório permite ver as despesas</ajuda><layout dados="select 
    e.nome as empresa_nome, 
    e.grid as empresa, 
    m.conta_debitar, 
    c.nome as conta_nome, 
    coalesce(p.nome,&apos;FORNECEDOR NÃO IDENTIFICADO**&apos;) as pessoa_nome, 
    sum(m.valor) as valor 
from 
    movto m 
       join conta c on (m.conta_debitar=c.codigo) 
       left join pessoa p on (m.pessoa=p.grid) 
       join empresa e on (m.empresa=e.grid) 
where 
    (case when $conta is null then true else (case when $listar_subconta=0 then m.conta_debitar=$conta else m.conta_debitar like $conta||&apos;%&apos; end) end)
and     (case when $empresa is null then true else m.empresa = $empresa end)
and     (case when $data_emis_ini is null then ((m.data between $data_pgto_ini and $data_pgto_fim and m.conta_creditar like &apos;1.%&apos;) or (movto_data_baixa_f(m.grid) between $data_pgto_ini and $data_pgto_fim and m.conta_creditar like &apos;2.%&apos;)) else (m.data between $data_emis_ini and $data_emis_fim) end)
group by 
    m.conta_debitar, 
    c.nome,
    p.nome, 
    e.nome, 
    e.grid 
order by 
    1,
    5" id="3d55cb1af44f23053e337e90270d01e4" ordem="" titulo="Despesas"><apelidos>1  rel_posto_nome	tam=40
2  rel_data_hora	tam=18
3  titulo1          	tam=82 	alinha=centro
4  titulo2    		tam=82 	alinha=centro
5  conta_debitar	tam=6
6  conta_nome		tam=33
7  pessoa_nome   	tam=60
8  valor		tam=12  fmt=%.02f
9  valor_sub_total	tam=12  fmt=%.02f	func=soma	campo=valor	grupo=1
10 valor_total		tam=12  fmt=%.02f	func=soma	campo=valor
11 empresa_nome		tam=30
12 empresa		tam=30
</apelidos><cab_pagina>
#1                                                                #2
----------------------------------------------------------------------------------

#3
#4
</cab_pagina>
<cab_grupo nome="1" quebra="empresa_nome" quebra_pagina="0">

+--------------------------------------------------------------------------------+
| Empresa: #11                                                                   |
+------------------------------------------------------------------+-------------+
| Titular                                                          |       Valor | 
+------------------------------------------------------------------+-------------+
</cab_grupo>
<detalhe>
| #7                                                               | #8          |
</detalhe>
<rod_grupo nome="1">
+------------------------------------------------------------------+-------------+
| Sub-total                                                        | #9          |
+------------------------------------------------------------------+-------------+

</rod_grupo>

<rod_relat>
+------------------------------------------------------------------+-------------+
| Total                                                            | #10         |
+------------------------------------------------------------------+-------------+
</rod_relat>

<rod_pagina>
+------------------------------------------------------------------+-------------+
</rod_pagina>
</layout></relatorio>