<?xml version='1.0' encoding='iso8859-1'?>
<relatorio ts="2008-09-29 14:59:38" versao_xml="0.1"><tela titulo="Sobras e Faltas de Caixa">
  <quadro titulo="Parâmetros">
    <procura id="empresa" modelo="empresa" titulo="Empresa" valor_padrao="select empresa from empresa_local" />
    <campo id="data" modelo="periodo" requerido="sim" titulo="Período" valor_padrao="select to_char(current_date, &apos;YYYY-mm-01&apos;)::date, to_char(current_date + interval &apos;1 month&apos;, &apos;YYYY-mm-01&apos;)::date - 1" />
    <procura condicao="codigo in (select codigo from conta where codigo like &apos;1.1.%&apos;)" id="conta" modelo="conta" titulo="Conta" />
    <procura id="responsavel" modelo="pessoa" titulo="Responsável" />
  </quadro>
</tela><ajuda>&lt;big&gt;&lt;b&gt;Relatório de Sobras e Faltas de Caixa&lt;/b&gt;&lt;/big&gt;

Este relatório permite ver as Sobras e Faltas de Caixa</ajuda><layout dados="select
    empresa_nome,
    conta_nome,
    conta_codigo,
    data,
    (case when turno = 1 then valor else 0 end) as valor1,
    (case when turno = 2 then valor else 0 end) as valor2,
    (case when turno = 3 then valor else 0 end) as valor3,
    (case when turno = 4 then valor else 0 end) as valor4,
    valor
from
    (select  
        pessoa_nome(m.empresa) as empresa_nome, 
        c.nome as conta_nome, 
        c.codigo as conta_codigo,
        m.turno,
        m.data,
        sum(case when c.codigo = m.conta_creditar then (valor * -1) else m.valor end) as valor
    from 
        movto m 
           join conta c on (c.codigo = m.conta_creditar or c.codigo = m.conta_debitar) 
    where 
        data between $data_ini and $data_fim
    and     (case when $empresa is null then true else empresa = $empresa end)
    and     (case when $responsavel is null then true else pessoa = $responsavel end)
    and     motivo in ((select motivo from motivo_config where chave=&apos;SOBRA_CAIXA&apos;),(select motivo from motivo_config where chave=&apos;FALTA_CAIXA&apos;))
    and     (case when $conta is null then codigo like &apos;1.1.%&apos; else c.codigo = $conta end)
    group by
        m.empresa,
        c.nome,
        m.turno,
        c.codigo,
        m.data) t
order by 
    1,2,4" id="b1df05a834bc38ee330fd7113bb63555" ordem=" " titulo="Sobras e Faltas de Caixa"><apelidos>1  rel_posto_nome       tam=60
2  rel_data_hora        tam=18
3  data_ini  		tam=10	fmt=data
4  data_fim  		tam=10	fmt=data
5  empresa_nome         tam=23
6  conta_nome           tam=38
7  data                 tam=10  fmt=data
8  valor1 		tam=11  fmt=%.02f	alinha=direita
9  valor2 		tam=11  fmt=%.02f	alinha=direita
10 valor3 		tam=11  fmt=%.02f	alinha=direita
11 valor4 		tam=11  fmt=%.02f	alinha=direita
12 valor 		tam=11  fmt=%.02f	alinha=direita
13 saldo 		tam=13  fmt=%.02f	alinha=direita	func=soma	campo=valor
14 total_valor1		tam=11  fmt=%.02f	alinha=direita	func=soma	campo=valor1
15 total_valor2		tam=11  fmt=%.02f	alinha=direita	func=soma	campo=valor2
16 total_valor3		tam=11  fmt=%.02f	alinha=direita	func=soma	campo=valor3
17 total_valor4		tam=11  fmt=%.02f	alinha=direita	func=soma	campo=valor4</apelidos><cab_pagina>
#1                                                                                  #2        
----------------------------------------------------------------------------------------------------
 
                              RELATÓRIO DE SOBRAS E FALTAS DE CAIXA
                                  Período #3         a #4       

</cab_pagina>

<cab_grupo nome="1" quebra="empresa_nome,conta_codigo">
+----------------------------------------+---------------------------------------------------------+
| Empresa: #5                            | Conta: #6                                               |
+------------+-------------+-------------+-------------+-------------+-------------+---------------+
|   Data     |    1º turno |    2º turno |    3º turno |    4º turno |       Geral |     Acumulado |
+------------+-------------+-------------+-------------+-------------+-------------+---------------+
</cab_grupo>

<detalhe>
| #7         | #8          | #9          | #10         | #11         | #12         | #13           |
</detalhe>

<rod_grupo nome="1">
+------------+-------------+-------------+-------------+-------------+-------------+---------------+
| Total      | #14         | #15         | #16         | #17         |             | #13           |
+------------+-------------+-------------+-------------+-------------+-------------+---------------+

</rod_grupo>

<rod_pagina>
+--------------------------------------------------------------------------------------------------+
</rod_pagina>
</layout></relatorio>