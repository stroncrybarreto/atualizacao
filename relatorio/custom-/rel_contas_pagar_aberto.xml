<?xml version='1.0' encoding='iso8859-1'?>
<relatorio ts="2008-09-12 11:14:56" versao_xml="0.1"><tela titulo="Contas a Pagar">
  <quadro titulo="Parametros">
    <procura id="empresa" modelo="empresa" titulo="Empresa" valor_padrao="select grid from empresa_local" />
    <procura id="conta" modelo="conta" requerido="sim" titulo="Conta" />
    <procura id="grupo_pessoa" modelo="grupo_pessoa" titulo="Grupo pessoa" />
    <procura id="fornecedor" modelo="pessoa" titulo="Fornecedor" />
    <campo id="data" modelo="periodo" titulo="Período" valor_padrao="select to_char(current_date, &apos;YYYY-mm-01&apos;)::date, to_char(current_date + interval &apos;1 month&apos;, &apos;YYYY-mm-01&apos;)::date - 1" />
    <caixa>
      <check id="subconta" titulo="Selecionar subcontas" valor_padrao="select 1" />
      <check id="exibir" titulo="Exibir nome da conta" valor_padrao="select 1" />
    </caixa>
  </quadro>
</tela><ajuda>&lt;big&gt;&lt;b&gt;Relatorio de Contas a Pagar/b&gt;&lt;/big&gt;

Este relatório permite ver as Contas a Pagar</ajuda><layout dados="select 
    to_char(m.vencto,&apos;dd/mm/yy&apos;) as movto_vencto, 
    m.obs as movto_obs, 
    m.documento as movto_documento, 
    m.valor as movto_valor, 
    (case when $empresa is null then &apos;TODOS OS POSTOS&apos; else &apos;Empresa: &apos;||e.nome end) as empresa_nome, 
    p.nome as pessoa_nome,
    to_char(m.data_doc,&apos;dd/mm/yy&apos;) as movto_data_doc,     
    (case when $exibir=1 then cd.nome else m.conta_debitar end) as nome_conta_debitar,
    (case when $exibir=1 then cc.nome else m.conta_creditar end) as nome_conta_creditar
from 
    movto m
       left join pessoa p on (p.grid=m.pessoa) 
       left join motivo_movto mm on (mm.grid=m.motivo) 
       join empresa e on (e.grid=m.empresa) 
       join conta cd on (m.conta_debitar=cd.codigo)
       join conta cc on (m.conta_creditar=cc.codigo)
where
     (m.child=0 or m.child is null)
and     m.vencto between $data_ini and $data_fim
and     (case when $subconta=0 then m.conta_creditar = $conta else m.conta_creditar like $conta||&apos;%&apos; end)
and     (case when $fornecedor is null then true else p.grid = $fornecedor and p.tipo like &apos;%F%&apos; end)
and     (case when $empresa is null then true else m.empresa = $empresa end)
and     (case when $grupo_pessoa is null then true else p.grupo = $grupo_pessoa end)
order by
    m.data_doc,
    m.vencto,
    p.nome,
    m.documento" id="4926af86b780ec1532e27002f617f068" ordem=" " titulo="Sem Agrupamento"><apelidos>1  rel_posto_nome	tam=60
2  rel_data_hora	tam=18
3  data_ini		tam=10  fmt=data
4  data_fim		tam=10  fmt=data
6  movto_vencto		tam=8
7  movto_documento	tam=7
8  movto_data_doc	tam=8
9  pessoa_nome		tam=19
10 movto_obs		tam=19
11 movto_valor		tam=9  fmt=%.02f
13 total		tam=9  fmt=%.02f	func=soma	campo=movto_valor
14 empresa_nome		tam=122 alinha=centro
15 nome_conta_creditar	tam=16
16 nome_conta_debitar	tam=18</apelidos><cab_pagina>
#1                                                                                                          #2              
----------------------------------------------------------------------------------------------------------------------------

                                                     CONTAS A PAGAR
#14

                                                 #3         - #4             

+----------+---------+----------+-----------------+-------------------+--------------------+--------------------+----------+
| Vencto   | Docum.  | Dt Emiss | Conta Crédito   | Conta Débito      | Pessoa             | Observação         | Vl Pagar |
+----------+---------+----------+-----------------+-------------------+--------------------+--------------------+----------+
</cab_pagina>

<detalhe>
| #6       | #7      | #8       | #15             | #16               | #9                 | #10                | #11      |
</detalhe>

<rod_relat>
+----------+---------+----------+-----------------+-------------------+--------------------+--------------------+----------+
| TOTAL                                                                                                         | #13      |
+---------------------------------------------------------------------------------------------------------------+----------+
</rod_relat>

<rod_pagina>
+--------------------------------------------------------------------------------------------------------------------------+
</rod_pagina></layout><layout dados="select 
    to_char(m.vencto,&apos;dd/mm/yy&apos;) as movto_vencto, 
    m.obs as movto_obs, 
    m.documento as movto_documento, 
    m.valor as movto_valor, 
    (case when $empresa is null then &apos;TODOS OS POSTOS&apos; else &apos;Empresa: &apos;||e.nome end) as empresa_nome, 
    p.nome as pessoa_nome,
    (case when to_char(m.vencto,&apos;D&apos;)=1 then &apos;Domingo&apos; when to_char(m.vencto,&apos;D&apos;)=2 then &apos;Segunda-feira&apos; when to_char(m.vencto,&apos;D&apos;)=3 then &apos;Terça-feira&apos; when to_char(m.vencto,&apos;D&apos;)=4 then &apos;Quarta-feira&apos; when to_char(m.vencto,&apos;D&apos;)=5 then &apos;Quinta-feira&apos; when to_char(m.vencto,&apos;D&apos;)=6 then &apos;Sexta-feira&apos; else &apos;Sábado&apos; end) as dia_semana,     
    (case when $exibir=1 then cd.nome else m.conta_debitar end) as nome_conta_debitar,
    (case when $exibir=1 then cc.nome else m.conta_creditar end) as nome_conta_creditar
from 
    movto m
       left join pessoa p on (p.grid=m.pessoa) 
       left join motivo_movto mm on (mm.grid=m.motivo) 
       join empresa e on (e.grid=m.empresa)  
       join conta cd on (m.conta_debitar=cd.codigo)
       join conta cc on (m.conta_creditar=cc.codigo)
where
     (m.child=0 or m.child is null)
and     m.vencto between $data_ini and $data_fim
and     (case when $subconta=0 then m.conta_creditar = $conta else m.conta_creditar like $conta||&apos;%&apos; end)
and     (case when $fornecedor is null then true else p.grid = $fornecedor and p.tipo like &apos;%F%&apos; end)
and     (case when $empresa is null then true else m.empresa = $empresa end)
and     (case when $grupo_pessoa is null then true else p.grupo = $grupo_pessoa end)
order by
    m.data_doc,
    m.vencto,
    p.nome,
    m.documento" id="d12964aec82802a7e79a566b871c46e6" ordem="" titulo="Agrupar por Data"><apelidos>1  rel_posto_nome       tam=60
2  rel_data_hora        tam=18
3  data_ini           	tam=10  fmt=data
4  data_fim           	tam=10  fmt=data
6  movto_vencto		tam=8
7  movto_documento	tam=8
9  pessoa_nome		tam=23
10 movto_obs            tam=20
11 movto_valor		tam=9  fmt=%.02f
12 quebra_total		tam=9  fmt=%.02f	func=soma	campo=movto_valor	grupo=1
13 total		tam=9  fmt=%.02f	func=soma	campo=movto_valor
14 empresa_nome		tam=122 alinha=centro
20 dia_semana		tam=14
15 nome_conta_creditar	tam=16
16 nome_conta_debitar	tam=19</apelidos><cab_pagina>
#1                                                                                                          #2              
----------------------------------------------------------------------------------------------------------------------------

                                                     CONTAS A PAGAR
#14

                                                #3         - #4

</cab_pagina>
<cab_grupo nome="1" quebra="movto_vencto">
+--------------------------------------------------------------------------------------------------------------------------+
| Data: #6         - #20                                                                                                   |
+---------+----------+-------------------+----------------------+-------------------------+---------------------+----------+
| Docum.  | Vencto   | Conta Crédito     | Conta Débito         | Pessoa                  | Observação          | Vl Pagar |
+---------+----------+-------------------+----------------------+-------------------------+---------------------+----------+
</cab_grupo>

<detalhe>
| #7      | #6       | #15               | #16                  | #9                      | #10                 | #11      |
</detalhe>

<rod_grupo nome="1">
+---------+----------+-------------------+----------------------+-------------------------+---------------------+----------+
| SUBTOTAL                                                                                                      | #12      |
+---------------------------------------------------------------------------------------------------------------+----------+

</rod_grupo>

<rod_relat>
+---------------------------------------------------------------------------------------------------------------+----------+
| TOTAL                                                                                                         | #13      |
+---------------------------------------------------------------------------------------------------------------+----------+
</rod_relat>

<rod_pagina>
+--------------------------------------------------------------------------------------------------------------------------+
</rod_pagina>
</layout><layout dados="select 
    m.vencto as movto_vencto, 
    m.obs as movto_obs, 
    m.documento as movto_documento, 
    m.valor as movto_valor, 
    (case when $empresa is null then &apos;TODOS OS POSTOS&apos; else &apos;Empresa: &apos;||e.nome end) as empresa_nome, 
    p.nome as pessoa_nome,
    m.data_doc as movto_data_doc,     
    (case when $exibir=1 then cd.nome else m.conta_debitar end) as nome_conta_debitar,
    (case when $exibir=1 then cc.nome else m.conta_creditar end) as nome_conta_creditar
from 
    movto m
       left join pessoa p on (p.grid=m.pessoa) 
       left join motivo_movto mm on (mm.grid=m.motivo) 
       join empresa e on (e.grid=m.empresa)   
       join conta cd on (m.conta_debitar=cd.codigo)
       join conta cc on (m.conta_creditar=cc.codigo)
where
     (m.child=0 or m.child is null)
and     m.vencto between $data_ini and $data_fim
and     (case when $subconta=0 then m.conta_creditar = $conta else m.conta_creditar like $conta||&apos;%&apos; end)
and     (case when $fornecedor is null then true else p.grid = $fornecedor and p.tipo like &apos;%F%&apos; end)
and     (case when $empresa is null then true else m.empresa = $empresa end)
and     (case when $grupo_pessoa is null then true else p.grupo = $grupo_pessoa end)
order by
    p.nome,
    m.data_doc,
    m.vencto,
    m.documento" id="4382aedc5d957a362cfe3708e0d6cfc9" ordem="" titulo="Agrupado por Fornecedor"><apelidos>1  rel_posto_nome       tam=60
2  rel_data_hora        tam=18
3  data_ini           	tam=10  fmt=data
4  data_fim           	tam=10  fmt=data
6  movto_vencto		tam=10	fmt=data
7  movto_documento	tam=10
8  movto_data_doc	tam=10	fmt=data
9  pessoa_nome		tam=60
10 movto_obs            tam=26
11 movto_valor		tam=9  	fmt=%.02f
12 quebra_total		tam=9  	fmt=%.02f	func=soma	campo=movto_valor	grupo=1
13 total		tam=9  	fmt=%.02f	func=soma	campo=movto_valor
14 empresa_nome		tam=122	alinha=centro
15 nome_conta_creditar	tam=15
16 nome_conta_debitar	tam=19</apelidos><cab_pagina>
#1                                                                                                      #2
------------------------------------------------------------------------------------------------------------------------

                                                     CONTAS A PAGAR
#14

                                                #3         - #4


</cab_pagina>
<cab_grupo nome="1" quebra="pessoa_nome">
+----------------------------------------------------------------------------------------------------------------------+
| Fornecedor: #9                                                                                                       |
+------------+------------+------------+-----------------+---------------------+---------------------------+-----------+
| Vencimento | Documento  | Dt Emissão | Conta Crédito   | Conta Débito        | Observação                | Vl. Pagar |
+------------+------------+------------+-----------------+---------------------+---------------------------+-----------+
</cab_grupo>

<detalhe>
| #6         | #7         | #8         | #15             | #16                 | #10                       | #11       |
</detalhe>

<rod_grupo nome="1">
+------------+------------+------------+-----------------+---------------------+---------------------------+-----------+
| SUBTOTAL                                                                                                 | #12       |
+----------------------------------------------------------------------------------------------------------+-----------+

</rod_grupo>

<rod_relat>
+----------------------------------------------------------------------------------------------------------+-----------+
| TOTAL                                                                                                    | #13       |
+----------------------------------------------------------------------------------------------------------+-----------+
</rod_relat>

<rod_pagina>
+----------------------------------------------------------------------------------------------------------------------+
</rod_pagina>
</layout><layout dados="select 
    t.*,
    (case when to_char(t.vencto_fim,&apos;D&apos;)=1 then &apos;Domingo&apos; when to_char(t.vencto_fim,&apos;D&apos;)=2 then &apos;Segunda-feira&apos; when to_char(t.vencto_fim,&apos;D&apos;)=3 then &apos;Terça-feira&apos; when to_char(t.vencto_fim,&apos;D&apos;)=4 then &apos;Quarta-feira&apos; when to_char(t.vencto_fim,&apos;D&apos;)=5 then &apos;Quinta-feira&apos; when to_char(t.vencto_fim,&apos;D&apos;)=6 then &apos;Sexta-feira&apos; else &apos;Sábado&apos; end) as dia_semana_fim
from
    (select 
        extract(week from date(m.vencto)) as quebra,
        to_char(m.vencto,&apos;dd/mm/yy&apos;) as movto_vencto, 
        m.obs as movto_obs, 
        m.documento as movto_documento, 
        m.valor as movto_valor, 
        (case when $empresa is null then &apos;TODOS OS POSTOS&apos; else &apos;Empresa: &apos;||e.nome end) as empresa_nome, 
        p.nome as pessoa_nome,
        to_char(m.data_doc,&apos;dd/mm/yy&apos;) as movto_data_doc,
        (case when to_char(m.vencto,&apos;D&apos;)=1 then &apos;Domingo&apos; when to_char(m.vencto,&apos;D&apos;)=2 then &apos;Segunda-feira&apos; when to_char(m.vencto,&apos;D&apos;)=3 then &apos;Terça-feira&apos; when to_char(m.vencto,&apos;D&apos;)=4 then &apos;Quarta-feira&apos; when to_char(m.vencto,&apos;D&apos;)=5 then &apos;Quinta-feira&apos; when to_char(m.vencto,&apos;D&apos;)=6 then &apos;Sexta-feira&apos; else &apos;Sábado&apos; end) as dia_semana,
    (select max(vencto) from movto where extract(week from date(vencto))=extract(week from date(m.vencto)) and to_char(vencto,&apos;yyyy&apos;)=to_char(m.vencto,&apos;yyyy&apos;) and conta_creditar=m.conta_creditar and (child=0 or child is null)) as vencto_fim,     
        (case when $exibir=1 then cd.nome else m.conta_debitar end) as nome_conta_debitar,
        (case when $exibir=1 then cc.nome else m.conta_creditar end) as nome_conta_creditar
    from 
        movto m
           left join pessoa p on (p.grid=m.pessoa) 
           left join motivo_movto mm on (mm.grid=m.motivo) 
           join empresa e on (e.grid=m.empresa)    
       join conta cd on (m.conta_debitar=cd.codigo)
       join conta cc on (m.conta_creditar=cc.codigo)
    where
         (m.child=0 or m.child is null)
    and     m.vencto between $data_ini and $data_fim
    and     (case when $subconta=0 then m.conta_creditar = $conta else m.conta_creditar like $conta||&apos;%&apos; end)
    and     (case when $fornecedor is null then true else p.grid = $fornecedor and p.tipo like &apos;%F%&apos; end)
    and     (case when $empresa is null then true else m.empresa = $empresa end)
    and     (case when $grupo_pessoa is null then true else p.grupo = $grupo_pessoa end)) t
order by
    t.quebra,
    t.movto_vencto,
    t.movto_data_doc,
    t.pessoa_nome" id="1f9e01c4c9140fe0774916fcc4c20b52" ordem="" titulo="Agrupar por Semana"><apelidos>1  rel_posto_nome	tam=60
2  rel_data_hora        tam=18
3  data_ini           	tam=10  fmt=data
4  data_fim           	tam=10  fmt=data
6  movto_vencto		tam=8
7  movto_documento	tam=7
8  movto_data_doc	tam=8
9  pessoa_nome		tam=19
10 movto_obs            tam=19
11 movto_valor		tam=9  fmt=%.02f
12 quebra_total		tam=9  fmt=%.02f	func=soma	campo=movto_valor	grupo=1
13 total		tam=9  fmt=%.02f	func=soma	campo=movto_valor
14 empresa_nome		tam=130 alinha=centro
15 quebra
17 vencto_fim		tam=10	fmt=data
18 dia_semana		tam=13	alinha=centro
19 dia_semana_fim	tam=13
15 nome_conta_creditar	tam=15
16 nome_conta_debitar	tam=17</apelidos><cab_pagina>
#1                                                                                                          #2               
----------------------------------------------------------------------------------------------------------------------------

                                                       CONTAS A PAGAR
#14

                                                   #3         - #4


</cab_pagina>
<cab_grupo nome="1" quebra="quebra">
+--------------------------------------------------------------------------------------------------------------------------+
| Período: #6         - #18           até #17        - #19                                                                 |
+---------+----------+----------+-----------------+-------------------+--------------------+--------------------+----------+
| Docum.  | Dt Emiss | Vencto   | Conta Crédito   | Conta Crédito     | Pessoa             | Observação         | Vl Pagar |
+---------+----------+----------+-----------------+-------------------+--------------------+--------------------+----------+
</cab_grupo>

<detalhe>
| #7      | #8       | #6       | #15             | #16               | #9                 | #10                | #11      |
</detalhe>

<rod_grupo nome="1">
+---------+----------+----------+-----------------+-------------------+--------------------+--------------------+----------+
| SUBTOTAL                                                                                                      | #12      |
+---------------------------------------------------------------------------------------------------------------+----------+

</rod_grupo>

<rod_relat>
+---------------------------------------------------------------------------------------------------------------+----------+
| TOTAL                                                                                                         | #13      |
+---------------------------------------------------------------------------------------------------------------+----------+
</rod_relat>

<rod_pagina>
+--------------------------------------------------------------------------------------------------------------------------+
</rod_pagina>
</layout></relatorio>