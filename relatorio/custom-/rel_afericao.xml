<?xml version='1.0' encoding='iso8859-1'?>
<relatorio ts="2008-08-27 17:19:08" versao_xml="0.1"><tela titulo="Aferições">
  <quadro titulo="Parâmetros">
    <procura id="empresa" modelo="empresa" titulo="Empresa" />
    <procura condicao="grupo=105" id="responsavel" modelo="pessoa" titulo="Responsável" />
    <caixa>
      <procura condicao="(empresa = $empresa or $empresa is null) and produto is not null" id="tanque" modelo="deposito" titulo="Tanque" />
      <campo id="bico" tipo="inteiro" titulo="Bico" />
    </caixa>
    <procura condicao="tipo = &apos;C&apos;" id="combustivel" modelo="produto" titulo="Combustível" />
    <caixa>
      <campo id="data_ini" requerido="sim" tipo="data" titulo="Data inicial" valor_padrao="select to_char(current_date, &apos;YYYY-01-01&apos;)" />
      <campo id="turno_ini" tipo="inteiro" titulo="Turno inicial" />
    </caixa>
    <caixa>
      <campo id="data_fim" requerido="sim" tipo="data" titulo="Data final" valor_padrao="select current_date" />
      <campo id="turno_fim" tipo="inteiro" titulo="Turno final" />
    </caixa>
  </quadro>
</tela><ajuda>&lt;big&gt;&lt;b&gt;Relatorio de Aferições&lt;/b&gt;&lt;/big&gt;

Este relatório permite ver as Aferições</ajuda><layout dados="select 
    l.data, 
    l.turno,
    l.hora, 
    l.bico, 
    p.nome as produto_nome, 
    d.codigo||&apos; - &apos;||d.nome as deposito_cod_nome, 
    l.quantidade, 
    l.usuario,
    l.hora_abastec,
    pessoa_nome(l.empresa) as empresa_nome
from 
    lancto l,
    produto p,
    deposito d
where 
     operacao=&apos;A&apos;
and     p.grid = l.produto
and     d.grid = l.deposito
and     (case when $tanque is null then true else l.deposito = $tanque end)
and     (case when $responsavel is null then true else l.pessoa = $responsavel end)
and     (case when $combustivel is null then true else l.produto = $combustivel end)
and     (case when $bico is null then true else l.bico = $bico end)
and     l.data between $data_ini and $data_fim
/*and     (case when $turno_fim is null then l.turno&gt;=$turno_ini when $turno_ini is null then l.turno&lt;=$turno_fim when $turno_ini is null and $turno_fim is null then true else l.turno between $turno_ini and $turno_fim end)*/
and     (case when $empresa is null then true else l.empresa = $empresa end) 
order by 
    l.empresa, 
    l.data, 
    l.turno, 
    l.hora" id="b1df05a834bc38ee330fd7113bb63555" ordem=" " titulo="Aferições"><apelidos>1  rel_posto_nome	tam=60
2  rel_data_hora    	tam=18
4  titulo2		tam=109 		alinha=centro
5  empresa_nome		tam=60
6  data			tam=10 	fmt=data
7  turno		tam=5 			alinha=centro
8  hora			tam=5	fmt=hora 	
99 hora_abastec		tam=5 	
9  bico			tam=4 			alinha=centro
10 produto_nome		tam=25
11 deposito_cod_nome	tam=30
12 quantidade		tam=8	fmt=%8.01f	alinha=direita
13 total_afericao	tam=4			alinha=direita	func=contar
14 total_quantidade	tam=8	fmt=%8.01f	alinha=direita	func=soma	campo=quantidade
15 usuario		tam=12
16 data_ini		tam=10	fmt=data
17 data_fim		tam=10	fmt=data
</apelidos><cab_pagina>
#1                                                                                                        #2               
------------------------------------------------------------------------------------------------------------------------------------
 
                                    AFERICOES - De #16        a #17       
#4

</cab_pagina>
<cab_grupo nome="1" quebra="empresa_nome">
+-------------------------------------------------------------------------------------------------------------------+--------------+
| Empresa: #5                                                                                                                      |
+------------+-------+-------+-------+------+---------------------------+--------------------------------+----------+--------------+
|  Data      | Turno | Hora  | Baixa | Bico | Combustível               | Tanque                         |   Litros | Usuário      |
+------------+-------+-------+-------+------+---------------------------+--------------------------------+----------+--------------+
</cab_grupo>
<detalhe>
| #6         | #7    | #99   | #8    | #9   | #10                       | #11                            | #12      | #15          |
</detalhe>
<rod_grupo nome="1">
+------------+-------+-------+-------+------+---------------------------+--------------------------------+----------+--------------+
| #13  aferições                                                                                         | #14      |              |
+--------------------------------------------------------------------------------------------------------+----------+--------------+

</rod_grupo>
<rod_pagina>
+------------+-------+-------+-------+------+---------------------------+--------------------------------+----------+--------------+
</rod_pagina>
</layout></relatorio>