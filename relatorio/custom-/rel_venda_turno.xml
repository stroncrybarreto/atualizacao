<?xml version='1.0' encoding='iso8859-1'?>
<relatorio ts="2008-08-11 09:52:11" versao_xml="0.1"><tela titulo="Vendas por Turno">
  <quadro titulo="Parâmetros">
    <procura condicao="(case when (select grid from empresa_local limit 1) is null then true else codigo in (select conta from empresa_conta where empresa = (select grid from empresa_local limit 1)) end)" id="conta" modelo="conta" titulo="Conta" />
    <procura id="funcionario" modelo="funcionario" titulo="Responsável" />
    <campo id="data_periodo" modelo="periodo" titulo="Periodo" valor_padrao="SELECT to_char(current_date, &apos;YYYY-mm-01&apos;)::date, to_char(current_date + interval &apos;1 month&apos;, &apos;YYYY-mm-01&apos;)::date - 1" />
  </quadro>
</tela><ajuda>&lt;big&gt;&lt;b&gt;Relatorio de Vendas por Turno&lt;/b&gt;&lt;/big&gt;

Este relatório permite ver as Vendas por Turno</ajuda><layout dados="select 
     m.data, 
     m.turno, 
     sum(case when m.turno = 1 then m.valor else 0 end) as valor1, 
     sum(case when m.turno = 2 then m.valor else 0 end) as valor2, 
     sum(case when m.turno = 3 then m.valor else 0 end) as valor3, 
     sum(case when m.turno = 4 then m.valor else 0 end) as valor4, 
     sum(m.valor) as valor, 
     m.conta_debitar as conta_codigo, 
     e.codigo as empresa_codigo, 
     c.nome as conta_nome, 
     e.nome_reduzido as empresa_nome 
from 
     movto m 
          join motivo_movto mm on (mm.grid = m.motivo) 
          join empresa e on (e.grid = m.empresa) 
          join conta c on (c.codigo = m.conta_debitar) 
where 
     (case when(select motivo from motivo_config where chave = &apos;VENDA&apos;) is null then true else mm.grid =(select motivo from motivo_config where chave = &apos;VENDA&apos;) end)  
     and m.data between $data_periodo_ini and $data_periodo_fim  
     and (case when $conta is null then true else m.conta_debitar = $conta end)  
     and (case when $funcionario is null then true else m.pessoa = $funcionario end)  
     and (case when(select grid from empresa_local limit 1) is null then true else m.empresa in(select grid from empresa_local limit 1) end)  
group by 
     m.data, 
     m.turno, 
     m.conta_debitar, 
     e.codigo, 
     c.nome, 
     e.nome_reduzido 
order by 
     m.data, 
     m.turno" id="421ec70582cdd3b05a17ac28d18146b7" ordem="  " titulo=""><apelidos>1  rel_posto_nome       tam=60
2  rel_data_hora        tam=18
3  titulo		tam=100 alinha=centro
4  empresa_nome         tam=23
5  conta_nome           tam=38
6  data                 tam=10  fmt=data
7  valor1		tam=12  fmt=%.02f
8  valor2		tam=12  fmt=%.02f
9  valor3		tam=12  fmt=%.02f
10 valor4		tam=12  fmt=%.02f
11 total_valor1		tam=12  fmt=%.02f	func=soma	campo=valor1	grupo=1
12 total_valor2		tam=12  fmt=%.02f	func=soma	campo=valor2	grupo=1
13 total_valor3		tam=12  fmt=%.02f	func=soma	campo=valor3	grupo=1
14 total_valor4		tam=12  fmt=%.02f	func=soma	campo=valor4	grupo=1
15 valor		tam=12  fmt=%.02f
16 acumulado		tam=12  fmt=%.02f	func=soma	campo=valor	grupo=1
17 total_acumulado	tam=12  fmt=%.02f	func=soma	campo=valor	grupo=1
90 data_periodo_ini	tam=10  fmt=data 
91 data_periodo_fim	tam=10	fmt=data</apelidos><cab_pagina>
#1                                                                                  #2        
----------------------------------------------------------------------------------------------------
 
                                          VENDA POR TURNO
				  Período #90        a #91       

</cab_pagina>

<cab_grupo nome="1" quebra="conta_codigo">
+----------------------------------------+---------------------------------------------------------+
| Empresa: #4                            | Conta: #5                                               |
+------------+-------------+-------------+-------------+-------------+-------------+---------------+
|   Data     |    1º turno |    2º turno |    3º turno |    4º turno |       Geral |     Acumulado |
+------------+-------------+-------------+-------------+-------------+-------------+---------------+
</cab_grupo>

<detalhe>
| #6         | #7          | #8          | #9          | #10         | #15         | #16           |
</detalhe>

<rod_grupo nome="1">
+------------+-------------+-------------+-------------+-------------+-------------+---------------+
| Total      | #11         | #12         | #13         | #14         |             | #17           |
+------------+-------------+-------------+-------------+-------------+-------------+---------------+

</rod_grupo>

<rod_pagina>
+--------------------------------------------------------------------------------------------------+
</rod_pagina>
</layout></relatorio>