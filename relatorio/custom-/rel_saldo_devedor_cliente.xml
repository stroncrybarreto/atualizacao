<?xml version='1.0' encoding='iso8859-1'?>
<relatorio ts="2008-11-11 09:06:05" versao_xml="0.1"><tela titulo="Saldo devedor de clientes">
  <quadro titulo="Parâmetros">
    <procura id="empresa" modelo="empresa" titulo="Empresa" valor_padrao="select empresa from empresa_local" />
    <procura id="grupo" modelo="grupo_pessoa" titulo="Grupo Cliente" />
    <procura id="pessoa" modelo="pessoa" titulo="Cliente" />
    <caixa>
      <campo id="exibir" tipo="inteiro" titulo="Exibir até" />
      <rotulo titulo="clientes" />
    </caixa>
  </quadro>
</tela><ajuda /><layout dados="select 
    sum(m.valor) as valor_geral, 
    p.nome as pessoa_nome,
    coalesce((select sum(x.valor) from movto x left join movto_map xp on (xp.parent=x.grid) join conta c on (c.codigo=x.conta_debitar) where x.vencto &lt;= current_date and c.tipo_conta_receber and c.pendencia and x.child=0 and x.conta_debitar like (select conta from conta_config where chave = &apos;VALORES A RECEBER&apos;)||&apos;%&apos; and xp.grid is null and x.empresa = m.empresa and x.pessoa = p.grid),0) as valor_atrazado
from 
    movto m 
       join pessoa p on (p.grid=m.pessoa) 
       left join movto_map mp on (mp.parent=m.grid) 
       join conta c on (c.codigo=m.conta_debitar) 
where 
    c.tipo_conta_receber 
and     c.pendencia 
and     m.child=0 
and     m.conta_debitar like (select conta from conta_config where chave = &apos;VALORES A RECEBER&apos;)||&apos;%&apos; 
and     mp.grid is null 
and     (case when $empresa is null then true else m.empresa = $empresa end) 
and     (case when $pessoa is null then true else m.pessoa = $pessoa end) 
and     (case when $grupo is null then true else p.grupo = $grupo end) 
group by 
    p.grid, 
    p.nome,
    m.empresa
order by 
    valor_geral desc,
    p.nome
limit 
    coalesce($exibir,0)" id="3d55cb1af44f23053e337e90270d01e4" ordem="" titulo="Saldo devedor de clientes"><apelidos>1  rel_posto_nome	tam=60
2  rel_data_hora	tam=16
3  titulo1		tam=96   alinha=centro
4  titulo2		tam=96   alinha=centro
5  pessoa_nome 		tam=60
6  valor_atrazado	tam=13   fmt=%.02f
7  valor_geral		tam=13   fmt=%.02f
8  valor_atrazado_total	tam=13   fmt=%.02f	func=soma	campo=valor_atrazado
9  valor_geral_total	tam=13   fmt=%.02f	func=soma	campo=valor_geral</apelidos><cab_pagina>
#1                                                                              #2             
------------------------------------------------------------------------------------------------

                       S A L D O   D E V E D O R   D E   C L I E N T E S

+--------------------------------------------------------------+-------------------------------+
| Cliente                                                      | Atrazado      | Geral         |
+--------------------------------------------------------------+---------------+---------------+
</cab_pagina>

<detalhe>
| #5                                                           | #6            | #7            |
</detalhe>

<rod_pagina>
+--------------------------------------------------------------+---------------+---------------+
</rod_pagina>

<rod_relat>
+--------------------------------------------------------------+---------------+---------------+
|                                                              | #8            | #9            |
+--------------------------------------------------------------+---------------+---------------+
</rod_relat>
</layout></relatorio>