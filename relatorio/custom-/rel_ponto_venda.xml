<?xml version='1.0' encoding='iso8859-1'?>
<relatorio ts="2008-08-08 10:17:57" versao_xml="0.1"><tela titulo="Relatório de Ponto de Venda">
  <quadro titulo="Parâmetros">
    <procura condicao="(case when (select grid from empresa_local limit 1) is null then true else codigo in (select conta from empresa_conta where empresa = (select grid from empresa_local limit 1)) end)" id="ponto_venda" modelo="conta" requerido="sim" titulo="Ponto de Venda" valor_padrao="select null" />
    <caixa>
      <campo id="data" requerido="sim" tipo="data" titulo="Data Inicio" valor_padrao="select current_date" />
      <campo id="turno" tipo="inteiro" titulo="Turno" />
    </caixa>
    <check id="exibir_filhas" titulo="Exibir movimentos de contas filhas" valor_padrao="select 0" />
    <caixa>
      <check id="combustivel" titulo="Conbustiveis" valor_padrao="select 1" />
      <check id="mercadoria" titulo="Mercadorias" valor_padrao="select 1" />
      <check id="servico" titulo="Serviço" valor_padrao="select 1" />
    </caixa>
  </quadro>
</tela><ajuda>&lt;big&gt;&lt;b&gt;Relatorio de Ponto de Venda&lt;/b&gt;&lt;/big&gt;

Este relatório permite ver os Pontos de Venda</ajuda><layout dados="select       p.grupo,       g.codigo as grupo_codigo,       g.nome as grupo_nome,       p.codigo as produto_codigo,       p.nome as produto_nome,       p.unid_med as produto_unid_med,       l.preco_unit,       sum(l.quantidade) as quantidade,       sum(l.preco_unit * l.quantidade) as valor,       (case when $turno is null then &apos;TODOS&apos; else $turno::text end) as nome_turno,       &apos;VENDA DE PRODUTOS - &apos; || &apos;CONTA: &apos; || (select (codigo || &apos; - &apos; || nome) from conta where codigo = $ponto_venda) as titulo from       lancto l            join movto m on (l.mlid = m.mlid)            join produto p on (l.produto = p.grid)            left join grupo_produto g on (p.grupo = g.grid)  where       (case            when $ponto_venda is null then true else m.conta_debitar = $ponto_venda end)       and (case            when $data is null then true else m.data = $data end)       and (case            when $data is null then true else l.data = $data end)       and (case when (select grid from empresa_local limit 1) is null then true                    else m.empresa = (select grid from empresa_local limit 1) end)       and (case when (select grid from empresa_local limit 1) is null then true                    else l.empresa = (select grid from empresa_local limit 1) end)        and l.operacao = &apos;V&apos;       and (case when $turno is null then true else m.turno = $turno end)       and (case when $turno is null then true else m.turno = $turno end)       and (case when $combustivel = 1       and $mercadoria = 1       and $servico = 1 then tipo in (&apos;C&apos;,&apos;M&apos;,&apos;S&apos;)            when $combustivel = 1 and $mercadoria = 1 and $servico = 0 then tipo in (&apos;C&apos;,&apos;M&apos;)            when $combustivel = 1 and $mercadoria = 0 and $servico = 1 then tipo in (&apos;C&apos;,&apos;S&apos;)            when $combustivel = 1 and $mercadoria = 0 and $servico = 0 then tipo in (&apos;C&apos;)            when $combustivel = 0 and $mercadoria = 1 and $servico = 1 then tipo in (&apos;M&apos;,&apos;S&apos;)            when $combustivel = 0 and $mercadoria = 1 and $servico = 0 then tipo in (&apos;M&apos;)            when $combustivel = 0 and $mercadoria = 0 and $servico = 1 then tipo in (&apos;S&apos;) else true end)  group by       g.nome,       g.codigo,       p.grupo,       p.nome,       p.codigo,       p.unid_med,       l.preco_unit  order by       g.nome" id="4926af86b780ec1532e27002f617f068" ordem=" " titulo="sem agrupamento"><apelidos>1  rel_posto_nome       tam=60
2  rel_data_hora        tam=18
3  data                 tam=10  fmt=data
4  nome_turno           tam=5   alinha=esquerda
5  grupo_nome           tam=40
6  produto_nome         tam=40
7  produto_unid_med     tam=3
8  quantidade           tam=10  fmt=%.01f
9  preco_unit           tam=8   fmt=%.03f
10 valor                tam=12	fmt=%.02f
11 total_qtde_grupo     tam=10	fmt=%.01f
12 total_valor_grupo    tam=13	fmt=%.02f
13 total_qtde           tam=10	fmt=%.01f	func=soma	campo=valor
14 total_valor          tam=12	fmt=%.02f	func=soma	campo=valor
15 titulo               tam=92	alinha=centro</apelidos><cab_pagina>
#1                                                                          #2
--------------------------------------------------------------------------------------------
 
#15
                                Data: #3         - Turno: #4


+------------------------------------------+---------+------------+---------+--------------+
| Produto                                  | Unidade | Quantidade |   Preço |        Total |
+------------------------------------------+---------+------------+---------+--------------+
</cab_pagina>

<detalhe>
| #6                                       | #7      | #8         |#9       | #10          |
</detalhe>

<rod_relat>
+------------------------------------------+---------+------------+---------+--------------+
| TOTAL                                              | #13        |         | #14          |
+----------------------------------------------------+------------+---------+--------------+
</rod_relat>

<rod_pagina>
+------------------------------------------+---------+------------+---------+--------------+
</rod_pagina>
</layout><layout dados="select       p.grupo,g.codigo as grupo_codigo,g.nome as grupo_nome,       p.codigo as produto_codigo,       p.nome as produto_nome,       p.unid_med as produto_unid_med,       l.preco_unit,       sum(l.quantidade) as quantidade,       sum(l.preco_unit * l.quantidade) as valor,       (case when $turno is null then &apos;TODOS&apos; else $turno::text end) as nome_turno from       lancto l            join movto m on (l.mlid=m.mlid)            join produto p on (l.produto=p.grid)            left join grupo_produto g on (p.grupo=g.grid)  where       (case             when $ponto_venda is null then true else m.conta_debitar = $ponto_venda end)        and (case             when $data is null then true else m.data = $data end)        and (case             when $data is null then true else l.data = $data end)        and (case             when(select            grid       from            empresa_local       limit            1) is null then true else m.empresa =(select            grid       from            empresa_local       limit            1) end)        and (case             when (select            grid       from            empresa_local       limit            1) is null then true else l.empresa = (select            grid       from            empresa_local       limit            1) end)       and l.operacao = &apos;V&apos;       and (case            when $turno is null then true else m.turno = $turno end)       and (case            when $combustivel = 1       and $mercadoria = 1       and $servico = 1 then tipo in (&apos;C&apos;,&apos;M&apos;,&apos;S&apos;)            when $combustivel = 1       and $mercadoria = 1        and $servico = 0 then tipo in (&apos;C&apos;,&apos;M&apos;)             when $combustivel = 1        and $mercadoria = 0       and $servico = 1 then tipo in (&apos;C&apos;,&apos;S&apos;)            when $combustivel = 1       and $mercadoria = 0       and $servico = 0 then tipo in (&apos;C&apos;)            when $combustivel = 0       and $mercadoria = 1       and $servico = 1 then tipo in (&apos;M&apos;,&apos;S&apos;)            when $combustivel = 0       and $mercadoria = 1       and $servico = 0 then tipo in (&apos;M&apos;)            when $combustivel = 0       and $mercadoria = 0       and $servico = 1 then tipo in (&apos;S&apos;) else true end)  group by       g.nome,       g.codigo,       p.grupo,       p.nome,       p.codigo,       p.unid_med,       l.preco_unit  order by       p.nome" id="1432a2435279fd9ec8674495423400a8" ordem=" " titulo="agrupado por grupo de produto"><apelidos>1  rel_posto_nome       tam=60
2  rel_data_hora        tam=18
3  data                 tam=10  fmt=data
4  nome_turno           tam=5   alinha=esquerda
5  grupo_nome           tam=40
6  produto_nome         tam=40
7  produto_unid_med     tam=3
8  quantidade           tam=10  fmt=%.01f
9  preco_unit           tam=8   fmt=%.03f
10 valor                tam=12  fmt=%.02f
11 total_qtde_grupo     tam=10  fmt=%.01f	func=soma	campo=quantidade	grupo=1
12 total_valor_grupo    tam=13  fmt=%.02f	func=soma	campo=valor		grupo=1
13 total_qtde           tam=10  fmt=%.01f	func=soma	campo=quantidade
14 total_valor          tam=12  fmt=%.02f	func=soma	campo=valor</apelidos><cab_pagina>
#1                                                                          #2
--------------------------------------------------------------------------------------------
 
                                     VENDA DE PRODUTOS
                                Data: #3         - Turno: #4

</cab_pagina>

<cab_grupo nome="1" quebra="grupo">
GRUPO: #5
+------------------------------------------+---------+------------+---------+--------------+
| Produto                                  | Unidade | Quantidade |   Preço |        Total |
+------------------------------------------+---------+------------+---------+--------------+
</cab_grupo>

<detalhe>
| #6                                       | #7      | #8         |#9       | #10          |
</detalhe>

<rod_grupo nome="1">
+------------------------------------------+---------+------------+---------+--------------+
| SUBTOTAL                                           | #11        |         | #12          |
+----------------------------------------------------+------------+---------+--------------+

</rod_grupo>

<rod_relat>
+------------------------------------------+---------+------------+---------+--------------+
| TOTAL                                              | #13        |         | #14          |
+----------------------------------------------------+------------+---------+--------------+
</rod_relat>

<rod_pagina>
+------------------------------------------+---------+------------+---------+--------------+
</rod_pagina></layout></relatorio>